#!/bin/bash

LIMIT=20000
DS_NAME="ReasonVQA"
DS_VERSION="unbalanced"

DS_DIR="../dataset/${DS_VERSION}"
MODEL_TYPE=""

case $1 in
# ======================================== mPLUGOwl3
  1)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=0
    MULTICHOICE=true
    ;;
  2)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=20000
    MULTICHOICE=true
    ;;
  3)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=40000
    MULTICHOICE=true
    ;;
  4)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=60000
    MULTICHOICE=true
    ;;
  5)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=0
    MULTICHOICE=false
    ;;
  6)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=20000
    MULTICHOICE=false
    ;;
  7)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=40000
    MULTICHOICE=false
    ;;
  8)
    CONDA_ENV="owl3"
    MODEL_NAME="mPLUGOwl3"
    START=60000
    MULTICHOICE=false
    ;;
# ======================================== Idefics2
  9)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=0
    MULTICHOICE=true
    ;;
  10)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=20000
    MULTICHOICE=true
    ;;
  11)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=40000
    MULTICHOICE=true
    ;;
  12)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=60000
    MULTICHOICE=true
    ;;
  13)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=0
    MULTICHOICE=false
    ;;
  14)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=20000
    MULTICHOICE=false
    ;;
  15)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=40000
    MULTICHOICE=false
    ;;
  16)
    CONDA_ENV="owl3"
    MODEL_NAME="idefics2"
    START=60000
    MULTICHOICE=false
    ;;
# ======================================== LLaVA
  17)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=0
    MULTICHOICE=true
    ;;
  18)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=20000
    MULTICHOICE=true
    ;;
  19)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=40000
    MULTICHOICE=true
    ;;
  20)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=60000
    MULTICHOICE=true
    ;;
  21)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=0
    MULTICHOICE=false
    ;;
  22)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=20000
    MULTICHOICE=false
    ;;
  23)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=40000
    MULTICHOICE=false
    ;;
  24)
    CONDA_ENV="llava"
    MODEL_NAME="llava"
    START=60000
    MULTICHOICE=false
    ;;
# ======================================== LLaVA-NEXT
  25)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=0
    MULTICHOICE=true
    ;;
  26)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=20000
    MULTICHOICE=true
    ;;
  27)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=40000
    MULTICHOICE=true
    ;;
  28)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=60000
    MULTICHOICE=true
    ;;
  29)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=0
    MULTICHOICE=false
    ;;
  30)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=20000
    MULTICHOICE=false
    ;;
  31)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=40000
    MULTICHOICE=false
    ;;
  32)
    CONDA_ENV="llava_next"
    MODEL_NAME="llava_next_stronger"
    START=60000
    MULTICHOICE=false
    ;;
# ======================================== Mantis-SIGLIP
  33)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=0
    MULTICHOICE=true
    ;;
  34)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=20000
    MULTICHOICE=true
    ;;
  35)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=40000
    MULTICHOICE=true
    ;;
  36)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=60000
    MULTICHOICE=true
    ;;
  37)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=0
    MULTICHOICE=false
    ;;
  38)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=20000
    MULTICHOICE=false
    ;;
  39)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=40000
    MULTICHOICE=false
    ;;
  40)
    CONDA_ENV="mantis_siglip"
    MODEL_NAME="mantis_siglip"
    START=60000
    MULTICHOICE=false
    ;;
# ======================================== Mantis-Idefics2
  41)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=0
    MULTICHOICE=true
    ;;
  42)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=20000
    MULTICHOICE=true
    ;;
  43)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=40000
    MULTICHOICE=true
    ;;
  44)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=60000
    MULTICHOICE=true
    ;;
  45)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=0
    MULTICHOICE=false
    ;;
  46)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=20000
    MULTICHOICE=false
    ;;
  47)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=40000
    MULTICHOICE=false
    ;;
  48)
    CONDA_ENV="owl3"
    MODEL_NAME="mantis_idefics2"
    START=60000
    MULTICHOICE=false
    ;;
  # ======================================== LLaVA-OV
    49)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=0
      MULTICHOICE=true
      ;;
    50)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=20000
      MULTICHOICE=true
      ;;
    51)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=40000
      MULTICHOICE=true
      ;;
    52)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=60000
      MULTICHOICE=true
      ;;
    53)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=0
      MULTICHOICE=false
      ;;
    54)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=20000
      MULTICHOICE=false
      ;;
    55)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=40000
      MULTICHOICE=false
      ;;
    56)
      CONDA_ENV="llava_ov"
      MODEL_NAME="llava_ov"
      START=60000
      MULTICHOICE=false
      ;;
  # ======================================== Qwen25
    57)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=0
      MULTICHOICE=true
      ;;
    58)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=20000
      MULTICHOICE=true
      ;;
    59)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=40000
      MULTICHOICE=true
      ;;
    60)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=60000
      MULTICHOICE=true
      ;;
    61)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=0
      MULTICHOICE=false
      ;;
    62)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=20000
      MULTICHOICE=false
      ;;
    63)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=40000
      MULTICHOICE=false
      ;;
    64)
      CONDA_ENV="qwen"
      MODEL_NAME="qwen25"
      START=60000
      MULTICHOICE=false
      ;;
  # ======================================== GPT
    65)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=0
      MULTICHOICE=true
      ;;
    66)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=20000
      MULTICHOICE=true
      ;;
    67)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=40000
      MULTICHOICE=true
      ;;
    68)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=60000
      MULTICHOICE=true
      ;;
    69)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=0
      MULTICHOICE=false
      ;;
    70)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=20000
      MULTICHOICE=false
      ;;
    71)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=40000
      MULTICHOICE=false
      ;;
    72)
      CONDA_ENV="openai"
      MODEL_NAME="gpt"
      START=60000
      MULTICHOICE=false
      ;;

esac

# allow internet connection
module load proxy4server-access
proxy_on


source activate $CONDA_ENV

OUTPUT_NAME=${MODEL_NAME}_${MODEL_TYPE}_${DS_NAME}_${DS_VERSION}_${START}

if [ "$MULTICHOICE" = true ] ; then
  python -m benchmark.start \
   --model_name $MODEL_NAME \
   --ds_name $DS_NAME \
   --ds_dir $DS_DIR \
   --output_dir_name output_mc_${OUTPUT_NAME} \
   --start_at $START \
   --limit $LIMIT \
   --multichoice
else
  python -m benchmark.start \
   --model_name $MODEL_NAME \
   --ds_name $DS_NAME \
   --ds_dir $DS_DIR \
   --output_dir_name output_${OUTPUT_NAME} \
   --start_at $START \
   --limit $LIMIT
fi
